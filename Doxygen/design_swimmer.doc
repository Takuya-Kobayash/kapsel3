/*!
\author J. Molina
\date 2013/01/21
\page page_design_swimmer Self-Propelled Swimmers
\see Squirmer_coord, operate_surface.cxx
\htmlonly
<p><div class="image">
   <img src="../images/squirmer.jpg" title="squirmer.jpg" width="30%" height="auto"/>
   <div class="caption"> Spherical coordinates at the surface of the squirming body </div>
</div></p>
\endhtmlonly
\f{align*}{
\hat{\vec{r}} &= \vec{r} / \sqrt{\hat{\vec{r}}\cdot\hat{\vec{r}}} \\
\hat{\vec{\phi}} &= \hat{\vec{e}}_3\times\hat{\vec{r}}/\sin\theta\\
\hat{\vec{\theta}} &= \hat{\vec{\phi}}\times\hat{\vec{r}}
\f}
\f{align*}{
\hat{\vec{e}}\cdot\hat{\vec{r}} &= \cos{\theta} \\
\hat{\vec{e}}\cdot\hat{\vec{r}}\,\hat{\vec{r}} - \hat{\vec{e}} &= \sin{\theta}\,\hat{\vec{\theta}}        
\f}
\f{align*}{
\vec{u}^s(\hat{\vec{r}}) &= \sum_{n=1}^\infty\frac{2}{n(n+1)} B_n\left(\hat{\vec{e}}\cdot\hat{\vec{r}} - \hat{\vec{e}}\right)P^\prime_n(\hat{\vec{e}}\cdot\hat{\vec{r}}) \\
\vec{u}^s(\hat{\vec{r}}) &= B_1\left(\sin\theta + \frac{\alpha}{2}\sin{2\theta}\right)\hat{\vec{\theta}}                         
\f}
\f{align*}{
u^{**} = u^{*} &+ \sum_{i=1}^N\varphi_i\left(\vec{V}^\prime_i + \vec{\Omega}^\prime_i\times\vec{r}_i + \vec{u}^s_i - \vec{u}^*\right) \\
       &+\sum_{i=1}^N\phi_i\left(\delta\vec{V}_i + \delta\vec{\Omega}_i\times\vec{r}_i\right)
\f}

\f{align*}{
\int\vdf{x}\phi_i\left(\delta\vec{V}_i + \delta\vec{\Omega}_i\times\vec{r}_i\right) &=
 -\int\vdf{x}\varphi_i\left(\vec{V}^\prime_i + \vec{\Omega}^\prime_i\times\vec{r}_i + \vec{u}^s_i - \vec{u}^*\right)\\
\int\vdf{x}\phi_i\vec{r}_i\times\left(\delta\vec{V}_i + \delta\vec{\Omega}_i\times\vec{r}_i\right) &= - \int\vdf{x}\varphi_i\vec{r}_i\times\left(\vec{V}^\prime_i + \vec{\Omega}^\prime_i\times\vec{r}_i + \vec{u}^s_i - \vec{u}^*\right)
\f}

\f{align*}{
M_i^{(0)} \delta\vec{V}_i + \delta\vec{\Omega}_i\times\vec{M}^{(1)}_i &= - S_i^{(0)}\vec{V}^\prime_i - \vec{\Omega}^\prime_i\times\vec{S}^{(1)}_i -\Delta\vec{v}_i \equiv \delta\vec{P}\\
\vec{M}^{(1)}_i\times\delta\vec{V}_i + \vec{M}^{(2)}_i\cdot\delta\vec{\Omega}_i &= 
- \vec{S}^{(1)}_i\times\vec{V}^\prime_i - \vec{S}^{(2)}_i\cdot\vec{\Omega}^\prime_i - \Delta\vec{w}_i \equiv \delta\vec{L}
\f}
\f{align*}{
M_i^{(0)} &= \int\vdf{x}\phi_i \approx M / \rho\\
\vec{M}_i^{(1)} &= \int\vdf{x}\phi_i\vec{r}_i \approx 0\\
\vec{M}_i^{(2)} &= \int\vdf{x}\phi_i\left(r_i^2\tensor{I} - \vec{r}\vec{r}\right) \approx \frac{2}{5}M a^2 \tensor{I}/\rho
\f}
\f{align*}{
\Delta\vec{v}_i &= \int\vdf{x}\varphi_i\left(\vec{u}^s_i - \vec{u}^*\right) \\
\Delta\vec{w}_i &= \int\vdf{x}\varphi_i \vec{r}_i\times\left(\vec{u}^s_i - \vec{u}^*\right)
\f}
\f{align*}{
\delta\vec{V}_i &= \left(\delta\vec{P} - \delta\vec{\Omega}_i\times\vec{M}^{(1)}_i\right) / M^{(0)}_i \\
\delta\vec{\Omega}_i &= \fancy{M}^{-1}_i\cdot\left[M_i^{(0)} \delta\vec{L} - \vec{M}^{(1)}_i\times\delta\vec{P}\right]
\f}
\f[
\fancy{M}_i = M^{(0)}_i \vec{M}^{(2)}_i - \norm{\vec{M}^{(1)}_i}\tensor{I} + \vec{M}^{(1)}_i\vec{M}^{(1)}_i
\f]
*/